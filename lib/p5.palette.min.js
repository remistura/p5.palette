/*! p5.palette.js v0.1.0 - April 06, 2024 - License: MIT */
function invalidValue(t,e){throw new Error(`Invalid ${t} value: `+e)}const clearStoredPalettes=()=>this.removeItem(STORAGE_KEY),createGradientPalette=(p5.prototype.clearStoredPalettes=clearStoredPalettes,({amount:e=5,end:t=this.color(255),start:s=this.color(0)}={})=>{var r=[],o=s,i=t;let h=0;for(let t=0;t<e-1;t++)r.push(this.lerpColor(o,i,h)),h+=1/e;return r.push(i),this.createPalette(r)}),createGrayscalePalette=(p5.prototype.createGradientPalette=createGradientPalette,({amount:t=5,end:e=255,start:s=0}={})=>{(t<2||255<t)&&invalidValue("amount",t);s=this.color(s),e=this.color(e);return this.createGradientPalette({amount:t,end:e,start:s})}),createPalette=(p5.prototype.createGrayscalePalette=createGrayscalePalette,t=>{let e=[];return Array.isArray(t)?e=t:("string"==typeof t||t instanceof String)&&t.split("-").forEach(t=>{e.push(this.color("#"+t))}),new Palette(this,e)}),createRandomPalette=(p5.prototype.createPalette=createPalette,(t,e)=>{var s=t||5,r=e||this.random,o=[];for(let t=0;t<s;t++)o.push(this.color(255*r(),255*r(),255*r()));return createPalette(o)}),exportStoredPalettes=(p5.prototype.createRandomPalette=createRandomPalette,()=>{let e="const hexPalettes = [";var t=loadStoredHexStrings();t&&(t.forEach(t=>{e+=`'${t}',`}),e=e.slice(0,-1),e+="];",this.saveStrings([e],"palettes-exported","js"))}),_loadColormindPalette=(p5.prototype.exportStoredPalettes=exportStoredPalettes,function(e,t){const s=new XMLHttpRequest,r=t=>{t=JSON.parse(t.response);if(t.result){const e=this.createPalette();return t.result.forEach(t=>{e.add(this.color(t))}),e}return null};let o=!1;if("function"==typeof e&&(o=!0,s.onreadystatechange=function(){var t;4===s.readyState&&200===s.status&&(t=r(s))&&e(t)}),s.open("POST",COLORMIND_API_URL,o),s.send(JSON.stringify({model:"default"})),4===s.readyState&&200===s.status){var i=r(s);if(i)return"function"==typeof this._decrementPreload&&this._decrementPreload(),i}}),_loadColourLoversPalette=(p5.prototype.loadColormindPalette=_loadColormindPalette,p5.prototype.registerPreloadMethod("loadColormindPalette",p5.prototype),t=>{const r=createPalette();return createPaletteFromColourLoversJsonp(COLOURLOVERS_API_URL+this.random(50)).then(e=>{for(let t=0;t<e.size();t++){var s=e.get(t);r.add(s)}"function"==typeof t&&t(r),"function"==typeof self._decrementPreload&&self._decrementPreload()}),r}),loadPalettes=(p5.prototype.loadColourLoversPalette=_loadColourLoversPalette,p5.prototype.registerPreloadMethod("loadColourLoversPalette",p5.prototype),t=>{if(t){const e=[];return t.forEach(t=>{e.push(this.createPalette(t))}),e}return null}),loadStoredPalettes=(p5.prototype.loadPalettes=loadPalettes,()=>{var t=loadStoredHexStrings();return t?this.loadPalettes(t):null}),storePalette=(p5.prototype.loadStoredPalettes=loadStoredPalettes,e=>{if(e&&!(e.size()<1)){e=e.toHexString();let t=loadStoredHexStrings();(t=t||[]).push(e),this.storeItem(STORAGE_KEY,JSON.stringify(t))}}),createPaletteFromColourLoversJsonp=(p5.prototype.storePalette=storePalette,e=>new Promise(function(s,t){httpDo(e,"jsonp",{jsonpCallback:"jsonCallback"}).then(t=>{const e=new Palette(this);t[0].colors.forEach(t=>{e.add(this.color("#"+t))}),s(e)})})),loadStoredHexStrings=()=>{var t=getItem(STORAGE_KEY);return t?JSON.parse(t):null},COLORMIND_API_URL="http://colormind.io/api/",COLOURLOVERS_API_URL="http://www.colourlovers.com/api/palettes/top?format=json&numResults=1&resultOffset=",STORAGE_KEY="p5.palette";class Palette{constructor(t,e){this.P=t,this.swatches=[],e&&Array.isArray(e)&&(this.swatches=this.#colorsToSwatches(e)),this.index=this.swatches.length?0:-1,this.weightedDist=[]}add(t){if(!t)throw new Error("Nothing to add to the palette");if(t instanceof Palette)for(const e of t.swatches)this.swatches.push(e.clone());else{if(!(t instanceof p5.Color))throw new Error("The argument must be a p5.Color or a Palette object");this.swatches.push(new Swatch(t))}return this.swatches.length&&this.index<0&&(this.index=0),this}addAnalogousColors(){var e=this.getAnalogous(),s=[];for(let t=0;t<this.size();t++)s.push(e.get(2*t),this.get(t),e.get(2*t+1));return this.swatches=this.#colorsToSwatches(s),this}addComplementaryColors(){var e=this.getComplementary(),s=[];for(let t=0;t<this.size();t++)s.push(this.get(t),e.get(t));return this.swatches=this.#colorsToSwatches(s),this}addSplitComplementaryColors(){var e=this.getSplitComplementary(),s=[];for(let t=0;t<this.size();t++)s.push(e.get(2*t),this.get(t),e.get(2*t+1));return this.swatches=this.#colorsToSwatches(s),this}addTriadicColors(){var e=this.getTriadic(),s=[];for(let t=0;t<this.size();t++)s.push(e.get(2*t)),s.push(this.get(t)),s.push(e.get(2*t+1));return this.colors=Array.from(s),this}clear(){this.swatches=[],this.index=-1}clone(){return this.P.createPalette(this.getColors())}current(){return this.swatches[this.index].color}darken(){this.P.push(),this.P.colorMode(HSB);var e=[];for(let t=0;t<this.size();t++){var s=this.get(t);e.push(this.P.color(this.P.hue(s),this.P.saturation(s),.9*this.P.brightness(s)))}return this.colors=Array.from(e),this.P.pop(),this}draw(t){var{borderColor:e=0,borderWeight:s=1,drawBorder:r=!1,fontSize:o=12,height:i=50,offset:h=0,showCursor:a=!1,showIndex:l=!1,showSkipped:n=!1,vertical:c=!1,width:d=50,x:t=0,y:u=0}=t||{};this.P.push(),this.P.noStroke();let p=t,P=u;var g=this.swatches.length;for(let t=0;t<g;t++){var w,f,m=this.swatches[t].color;r&&(this.P.noFill(),this.P.stroke(e),this.P.strokeWeight(s),this.P.rect(p,P,d,i)),this.P.noStroke(),this.P.fill(m),this.P.rect(p,P,d,i),l&&(this.P.colorMode(HSB),m=50<this.P.brightness(m)?0:255,this.P.fill(m),this.P.stroke(m),this.P.strokeWeight(1),this.P.textAlign(this.P.CENTER,this.P.CENTER),this.P.textSize(o),m=p+d/2,w=P+i/2,f=""+t,this.P.text(f,m,w),a)&&this.index===t&&(f=o<(f=textWidth(f))?f:o,this.P.noFill(),this.P.circle(m,w,1.5*f)),n&&this.swatches[t].skip&&(this.P.line(p,P,p+d,P+i),this.P.line(p+d,P,p,P+i)),p+=c?0:d+h,P+=c?i+h:0}return this.P.pop(),this}get(t){if(this.index<0||this.index>=this.swatches.length)return null;if(isNaN(t))return this.swatches[this.index].color;if(t<0||t>=this.swatches.length)throw new Error(`There's no color with index ${t} in the palette`);return this.swatches[t].color}getAnalogous(){const s=[];return this.swatches.forEach(t=>{var[t,e]=this.#getAnalogousColors(t.color);s.push(t,e)}),new Palette(this.P,s)}getColors(){const e=[];return this.swatches.forEach(t=>{e.push(t.color)}),e}getComplementary(){var t=this.swatches.map(t=>this.#getComplementary(t.color));return new Palette(this.P,t)}getSplitComplementary(){const s=[];return this.swatches.forEach(t=>{var[t,e]=this.#getSplitComplementary(t.color);s.push(t,e)}),new Palette(this.P,s)}getTriadic(){const s=[];return this.colors.forEach(t=>{var[t,e]=this.#getTriadic(t);s.push(t),s.push(e)}),new Palette(this.P,s)}insertGradients(e=5,t=!1){var s,r=[];for(let t=0;t<this.size()-1;t++){var o=this.get(t),i=this.get(t+1);r.push(createGradientPalette({amount:e,start:o,end:i}))}return t&&(t=this.get(this.size()-1),s=this.get(0),r.push(createGradientPalette({amount:e,start:t,end:s}))),this.clear(),r.forEach(t=>{t.remove(t.size()-1),this.colors=this.colors.concat(t.getColors())}),this}lerp(t){var e=Math.floor(t*(this.swatches.length-1));return e<0?this.swatches[0].color:e>=this.swatches.length-1?this.swatches[this.swatches.length-1].color:(t=(t-e/(this.swatches.length-1))*(this.swatches.length-1),color(this.swatches[e].color._getRed()+t*(this.swatches[e+1].color._getRed()-this.swatches[e].color._getRed()),this.swatches[e].color._getGreen()+t*(this.swatches[e+1].color._getGreen()-this.swatches[e].color._getGreen()),this.swatches[e].color._getBlue()+t*(this.swatches[e+1].color._getBlue()-this.swatches[e].color._getBlue())))}lighten(){this.P.push(),this.P.colorMode(HSB);for(let t=0;t<this.size();t++){var e=this.get(t),e=this.P.color(this.P.hue(e),.9*this.P.saturation(e),1.1*this.P.brightness(e));this.swatches[t].color=e}return this.P.pop(),this}log(t=!0){t?this.#logHorizontal():this.#logVertical()}next(){for(let t=0;t<this.swatches.length;t++){var e=this.swatches[this.index];if(this.#increaseIndex(),!e.skip)return e.color}throw"A palette should not have all colors skipped"}previous(){return--this.index<0&&(this.index=this.swatches.length-1),this.swatches[this.index].color}random(t){if(!(this.swatches.length<1))return t=t||this.P.random,this.weightedDist.length||(this.weightedDist=this.#createWeightedDistribution(this.swatches)),this.weightedDist[Math.floor(t()*this.weightedDist.length)]}remove(t){return this.swatches.splice(t,1),this.index>=this.swatches.length&&(this.index=this.swatches.length-1),this}reset(){return this.index=0,this}reverse(){return this.swatches.reverse(),this}set(t){if(!(t<0||t>=this.swatches.length))return this.index=t,this}setWeights(e){if(!e||e.length!=this.swatches.length)throw"Invalid length for weights array";for(let t=0;t<e.length;t++)this.swatches[t].weight=e[t];this.weightedDist=this.#createWeightedDistribution(this.swatches)}size(){return this.swatches.length}shuffle(t){const e=t||this.P.random;return this.swatches=this.swatches.sort(()=>e()-.5),this}skip(t){if(!this.#validIndex(t))throw"Invalid color index";this.swatches[t].skip=!0}unskip(t){if(!this.#validIndex(t))throw"Invalid color index";this.swatches[t].skip=!1}unskipAll(){this.swatches.forEach(t=>t.skip=!1)}sortByBrightness(){return this.swatches=this.swatches.sort((t,e)=>this.P.brightness(t.color)===this.P.brightness(e.color)?0:this.P.brightness(t.color)>this.P.brightness(e.color)?1:-1),this}sortByLightness(){return this.swatches=this.swatches.sort((t,e)=>this.P.lightness(t.color)===this.P.lightness(e.color)?0:this.P.lightness(t.color)>this.P.lightness(e.color)?1:-1),this}sortBySaturation(){return this.swatches=this.swatches.sort((t,e)=>this.P.saturation(t.color)===this.P.saturation(e.color)?0:this.P.saturation(t.color)>this.P.saturation(e.color)?1:-1),this}toHexString(){return this.toString().replaceAll("#","")}toString(t){const e=t&&t.separator||"-",s=t&&t.format||"#rrggbb";let r="";return this.swatches.forEach(t=>{r=(r+=t.color.toString(s))+e}),r=r.slice(0,-1)}#colorsToSwatches(t){return t.map(t=>{t=this.P.color(t);return new Swatch(t)})}#createWeightedDistribution(t){const s=[];return t.forEach(t=>{s.push(t.weight)}),[].concat(...t.map((t,e)=>Array(Math.ceil(100*s[e])).fill(t.color)))}#getAnalogousColors(t){this.P.push(),this.P.colorMode(this.P.HSB);var e=this.P.hue(t),s=this.P.saturation(t),t=this.P.brightness(t),r=this.P.color((e+330)%360,s,t),e=this.P.color((e+30)%360,s,t);return this.P.pop(),[r,e]}#getComplementary(t){this.P.push(),this.P.colorMode(this.P.HSB);var e=(this.P.hue(t)+180)%360,e=this.P.color(e,this.P.saturation(t),this.P.brightness(t));return this.P.pop(),e}#getSplitComplementary(t){this.P.push(),this.P.colorMode(this.P.HSB);var e=this.P.hue(t),s=this.P.saturation(t),t=this.P.brightness(t),r=this.P.color((e+150+360)%360,s,t),e=this.P.color((e+210+360)%360,s,t);return this.P.pop(),[r,e]}#getTetradic(t){}#getTriadic(t){this.P.push(),this.P.colorMode(this.P.HSB);var e=this.P.hue(t),s=this.P.saturation(t),t=this.P.brightness(t),r=this.P.color((e+120)%360,s,t),e=this.P.color((e+240)%360,s,t);return this.P.pop(),[r,e]}#increaseIndex(){++this.index===this.swatches.length&&(this.index=0)}#logHorizontal(){let e="";var s=[],r=[];for(let t=0;t<this.size();t++){var o=this.swatches[t].color.toString("#rrggbb");e+="%c ■ ",r.push("color: "+o),s.push(o)}console.log(e,...r),console.log("%c"+s.join(" "),"color:gray")}#logVertical(){this.swatches.forEach(t=>{t=t.color.toString("#rrggbb");console.log("%c %s ",`background: ${t}; color: #222; padding: 0.25em 2em; margin: 2px;`," "),console.log("%c"+t,"color:gray")})}#validIndex(t){return!(isNaN(t)||t<0||t>this.swatches.length)}}class Swatch{constructor(t,e=1,s=!1){if(!t)throw new Error("A swatch needs a color!");this.color=t,this.weight=e,this.skip=s}clone(){var t=this.color instanceof this.color.constructor?this.color.toString():this.color;return new Swatch(t,this.weight,this.skip)}}